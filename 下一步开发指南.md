# ä¸‹ä¸€æ­¥å¼€å‘æŒ‡å—

## ğŸ¯ **å½“å‰çŠ¶æ€**

âœ… **å·²å®Œæˆï¼ˆ40%ï¼‰ï¼š**
1. GAS ä¼¤å®³è®¡ç®—ç³»ç»Ÿï¼ˆExecution Calculationï¼‰
2. æ”»å‡»æŠ€èƒ½åŸºç±»ï¼ˆè¿‘æˆ˜/è¿œç¨‹/æŠ€èƒ½ï¼‰
3. æŠ•å°„ç‰©ç³»ç»Ÿï¼ˆç›´çº¿é£è¡Œ/æŠ›ç‰©çº¿é£è¡Œï¼‰
4. å•ä½æ•°æ®è¡¨ç»“æ„ï¼ˆFSGUnitDataRowï¼‰
5. å•ä½ç³»ç»Ÿé›†æˆï¼ˆDataTable åŠ è½½ã€æ”»å‡»èƒ½åŠ›æˆäºˆï¼‰

â³ **å¾…å®Œæˆï¼ˆ60%ï¼‰ï¼š**
1. è“å›¾èµ„äº§åˆ›å»ºï¼ˆGEã€GAã€BPï¼‰
2. StateTree AI æ”»å‡»é€»è¾‘
3. æ­¦å°†æŠ€èƒ½ï¼ˆæ›¹æ“ã€åˆ˜å¤‡ï¼‰
4. è®¡è°‹å¡ï¼ˆæµæœ¨è®¡ã€ç«çŸ¢è®¡ã€ç¥é€Ÿè®¡ï¼‰
5. ä¸»åŸå¼“ç®­æ‰‹ç³»ç»Ÿ

---

## ğŸš€ **æ¨èå¼€å‘è·¯çº¿**

### **æ–¹æ¡ˆ Aï¼šå®Œæ•´åŠŸèƒ½å®ç°ï¼ˆæ¨èï¼‰** â­

#### **ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºè“å›¾èµ„äº§ï¼ˆ1-2å°æ—¶ï¼‰**
```
1. GE_Damage_Baseï¼ˆä¼¤å®³ GameplayEffectï¼‰
   - Duration Policy: Instant
   - Executions: SG_DamageExecutionCalc

2. GA_Attack_Meleeï¼ˆè¿‘æˆ˜æ”»å‡»èƒ½åŠ›ï¼‰
   - åŸºç±»ï¼šSG_GameplayAbility_Attack
   - AttackType: Melee
   - DamageEffectClass: GE_Damage_Base

3. GA_Attack_Rangedï¼ˆè¿œç¨‹æ”»å‡»èƒ½åŠ›ï¼‰
   - åŸºç±»ï¼šSG_GameplayAbility_Attack
   - AttackType: Ranged
   - DamageEffectClass: GE_Damage_Base

4. BP_Projectile_Arrowï¼ˆå¼“ç®­æŠ•å°„ç‰©ï¼‰
   - åŸºç±»ï¼šSG_Projectile
   - ProjectileType: Parabolic

5. DT_UnitDataï¼ˆå•ä½æ•°æ®è¡¨ï¼‰
   - è¡Œç»“æ„ï¼šFSGUnitDataRow
   - æ·»åŠ æ­¥å…µã€å¼“å…µé…ç½®
```

#### **ç¬¬äºŒæ­¥ï¼šä¿®æ”¹ GrantAttackAbility() åŠ è½½è“å›¾ï¼ˆ30åˆ†é’Ÿï¼‰**
```cpp
// åœ¨ SG_UnitsBase.cpp ä¸­å–æ¶ˆæ³¨é‡Šï¼š
TSubclassOf<UGameplayAbility> AttackAbilityClass = nullptr;

if (UnitTypeTag.MatchesTag(FGameplayTag::RequestGameplayTag(FName("Unit.Type.Infantry"))))
{
    // åŠ è½½è¿‘æˆ˜æ”»å‡»èƒ½åŠ›
    AttackAbilityClass = LoadClass<UGameplayAbility>(
        nullptr,
        TEXT("/Game/Blueprints/GAS/Abilities/GA_Attack_Melee.GA_Attack_Melee_C")
    );
}
else if (UnitTypeTag.MatchesTag(FGameplayTag::RequestGameplayTag(FName("Unit.Type.Archer"))))
{
    // åŠ è½½è¿œç¨‹æ”»å‡»èƒ½åŠ›
    AttackAbilityClass = LoadClass<UGameplayAbility>(
        nullptr,
        TEXT("/Game/Blueprints/GAS/Abilities/GA_Attack_Ranged.GA_Attack_Ranged_C")
    );
}
```

#### **ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º StateTree AI Tasksï¼ˆ2-3å°æ—¶ï¼‰**
```
1. Task_FindTargetï¼ˆæŸ¥æ‰¾æœ€è¿‘çš„æ•Œäººï¼‰
2. Task_MoveToAttackRangeï¼ˆç§»åŠ¨åˆ°æ”»å‡»èŒƒå›´ï¼‰
3. Task_CheckTargetValidï¼ˆæ£€æŸ¥ç›®æ ‡æœ‰æ•ˆæ€§ï¼‰
4. Task_PerformAttackï¼ˆæ‰§è¡Œæ”»å‡»ï¼‰
```

#### **ç¬¬å››æ­¥ï¼šæµ‹è¯•å’Œè°ƒè¯•ï¼ˆ1å°æ—¶ï¼‰**
```
1. åˆ›å»ºæµ‹è¯•å…³å¡
2. æ”¾ç½®æµ‹è¯•å•ä½ï¼ˆæ­¥å…µ vs æ­¥å…µï¼‰
3. é…ç½® DataTable å¼•ç”¨
4. è¿è¡Œå¹¶è§‚å¯Ÿæ”»å‡»æµç¨‹
5. æ£€æŸ¥æ—¥å¿—è¾“å‡º
```

**æ€»æ—¶é—´ï¼š4-6 å°æ—¶**
**å®Œæˆåè¿›åº¦ï¼š70%**

---

### **æ–¹æ¡ˆ Bï¼šå¿«é€ŸéªŒè¯ï¼ˆå¦‚æœæ—¶é—´ç´§å¼ ï¼‰**

#### **æœ€å°å¯è¡Œæ–¹æ¡ˆï¼ˆ1-2å°æ—¶ï¼‰**
```
1. åªåˆ›å»º GE_Damage_Base å’Œ GA_Attack_Melee
2. æ‰‹åŠ¨åœ¨å•ä½è“å›¾ä¸­æˆäºˆæ”»å‡»èƒ½åŠ›ï¼ˆè·³è¿‡è‡ªåŠ¨æˆäºˆï¼‰
3. æ‰‹åŠ¨è°ƒç”¨ PerformAttack() æµ‹è¯•ï¼ˆè·³è¿‡ AIï¼‰
4. éªŒè¯ä¼¤å®³è®¡ç®—æ˜¯å¦æ­£ç¡®
```

**æ€»æ—¶é—´ï¼š1-2 å°æ—¶**
**å®Œæˆåè¿›åº¦ï¼š50%**

---

## ğŸ“‹ **è“å›¾èµ„äº§åˆ›å»ºè¯¦ç»†æ­¥éª¤**

### **1. GE_Damage_Baseï¼ˆåŸºç¡€ä¼¤å®³ GameplayEffectï¼‰**

```
åˆ›å»ºæ­¥éª¤ï¼š
1. Content Browser â†’ å³é”® â†’ Blueprint Class
2. æœç´¢ GameplayEffect â†’ é€‰æ‹©
3. å‘½åï¼šGE_Damage_Base
4. æ‰“å¼€è“å›¾ï¼š
   - Duration Policy: Instant
   - Modifiers: æ¸…ç©ºï¼ˆä¸ä½¿ç”¨ Modifierï¼‰
   - Executions: ç‚¹å‡» + æ·»åŠ 
     - Calculation Class: SG_DamageExecutionCalc
   - SetByCaller Magnitudes: ç‚¹å‡» + æ·»åŠ 
     - Data Tag: Data.Damage
     - Magnitude Calculation Type: SetByCaller
5. ä¿å­˜
```

### **2. GA_Attack_Meleeï¼ˆè¿‘æˆ˜æ”»å‡»èƒ½åŠ›ï¼‰**

```
åˆ›å»ºæ­¥éª¤ï¼š
1. Content Browser â†’ å³é”® â†’ Blueprint Class
2. æœç´¢ SG_GameplayAbility_Attack â†’ é€‰æ‹©
3. å‘½åï¼šGA_Attack_Melee
4. æ‰“å¼€è“å›¾ï¼š
   - Attack Config:
     - Attack Type: Melee
     - Damage Multiplier: 1.0
   - Effect Config:
     - Damage Effect Class: GE_Damage_Base
   - Animation Config:
     - Attack Montage: é€‰æ‹©æ”»å‡»åŠ¨ç”»ï¼ˆå¦‚æœæœ‰ï¼‰
5. ä¿å­˜
```

### **3. GA_Attack_Rangedï¼ˆè¿œç¨‹æ”»å‡»èƒ½åŠ›ï¼‰**

```
åˆ›å»ºæ­¥éª¤ï¼š
1. Content Browser â†’ å³é”® â†’ Blueprint Class
2. æœç´¢ SG_GameplayAbility_Attack â†’ é€‰æ‹©
3. å‘½åï¼šGA_Attack_Ranged
4. æ‰“å¼€è“å›¾ï¼š
   - Attack Config:
     - Attack Type: Ranged
     - Damage Multiplier: 1.0
   - Effect Config:
     - Damage Effect Class: GE_Damage_Base
   - Animation Config:
     - Attack Montage: é€‰æ‹©æ”»å‡»åŠ¨ç”»ï¼ˆå¦‚æœæœ‰ï¼‰
   - Projectile Config:
     - Projectile Class: BP_Projectile_Arrow
5. ä¿å­˜
```

### **4. BP_Projectile_Arrowï¼ˆå¼“ç®­æŠ•å°„ç‰©ï¼‰**

```
åˆ›å»ºæ­¥éª¤ï¼š
1. Content Browser â†’ å³é”® â†’ Blueprint Class
2. æœç´¢ SG_Projectile â†’ é€‰æ‹©
3. å‘½åï¼šBP_Projectile_Arrow
4. æ‰“å¼€è“å›¾ï¼š
   - Projectile Config:
     - Projectile Type: Parabolic
     - Projectile Speed: 2000
     - Gravity Scale: 1.0
     - Max Lifetime: 5.0
     - bPenetrate: false
   - Damage Config:
     - Damage Effect Class: GE_Damage_Base
     - Damage Multiplier: 1.0
   - Viewport:
     - æ·»åŠ  Static Meshï¼ˆç®­çŸ¢æ¨¡å‹ï¼‰
     - è°ƒæ•´ç¼©æ”¾å’Œæ—‹è½¬
5. ä¿å­˜
```

### **5. DT_UnitDataï¼ˆå•ä½æ•°æ®è¡¨ï¼‰**

```
åˆ›å»ºæ­¥éª¤ï¼š
1. Content Browser â†’ å³é”® â†’ Miscellaneous â†’ Data Table
2. é€‰æ‹©è¡Œç»“æ„ï¼šFSGUnitDataRow
3. å‘½åï¼šDT_UnitData
4. æ‰“å¼€ DataTableï¼š
   - ç‚¹å‡» + æ·»åŠ æ–°è¡Œ
   - è¡Œåç§°ï¼šInfantry_Basic
   - å¡«å†™æ•°æ®ï¼š
     - Unit Name: æ­¥å…µ
     - Base Health: 500
     - Base Attack Damage: 50
     - Base Move Speed: 400
     - Base Attack Speed: 1.5
     - Base Attack Range: 150
     - Attack Type: Melee
     - Unit Type Tag: Unit.Type.Infantry
     - Attack Montage: é€‰æ‹©åŠ¨ç”»ï¼ˆå¦‚æœæœ‰ï¼‰
   
   - ç‚¹å‡» + æ·»åŠ æ–°è¡Œ
   - è¡Œåç§°ï¼šArcher_Basic
   - å¡«å†™æ•°æ®ï¼š
     - Unit Name: å¼“å…µ
     - Base Health: 300
     - Base Attack Damage: 40
     - Base Move Speed: 400
     - Base Attack Speed: 1.0
     - Base Attack Range: 1000
     - Attack Type: Projectile
     - Unit Type Tag: Unit.Type.Archer
     - Attack Montage: é€‰æ‹©åŠ¨ç”»ï¼ˆå¦‚æœæœ‰ï¼‰
     - Projectile Class: BP_Projectile_Arrow
5. ä¿å­˜
```

---

## ğŸ” **æµ‹è¯•æ­¥éª¤**

### **åŸºç¡€åŠŸèƒ½æµ‹è¯•**

```
1. åˆ›å»ºæµ‹è¯•å…³å¡ï¼ˆTestMap_Combatï¼‰

2. æ”¾ç½®ç©å®¶æ­¥å…µï¼š
   - æ‹–å…¥ BP_Unit_Infantry
   - é…ç½®ï¼š
     - bUseDataTable: true
     - UnitDataTable: DT_UnitData
     - UnitDataRowName: Infantry_Basic
     - FactionTag: Unit.Faction.Player

3. æ”¾ç½®æ•Œæ–¹æ­¥å…µï¼š
   - æ‹–å…¥ BP_Unit_Infantry
   - é…ç½®ï¼š
     - bUseDataTable: true
     - UnitDataTable: DT_UnitData
     - UnitDataRowName: Infantry_Basic
     - FactionTag: Unit.Faction.Enemy

4. è¿è¡Œæ¸¸æˆï¼š
   - è§‚å¯Ÿæ—¥å¿—è¾“å‡ºï¼ˆLogSGGameplayï¼‰
   - æ£€æŸ¥æ˜¯å¦æˆåŠŸåŠ è½½ DataTable é…ç½®
   - æ£€æŸ¥æ˜¯å¦æˆåŠŸæˆäºˆæ”»å‡»èƒ½åŠ›

5. æ‰‹åŠ¨æµ‹è¯•æ”»å‡»ï¼ˆä¸´æ—¶ï¼‰ï¼š
   - åœ¨å•ä½è“å›¾ä¸­æ·»åŠ æŒ‰é”®äº‹ä»¶
   - æŒ‰é”®æ—¶è°ƒç”¨ PerformAttack()
   - è§‚å¯Ÿæ˜¯å¦æ’­æ”¾æ”»å‡»åŠ¨ç”»
   - è§‚å¯Ÿæ˜¯å¦é€ æˆä¼¤å®³
   - æ£€æŸ¥æ—¥å¿—è¾“å‡º
```

---

## âš ï¸ **æ³¨æ„äº‹é¡¹**

### **1. GameplayTag é…ç½®**
åœ¨å¼€å§‹ä¹‹å‰ï¼Œç¡®ä¿å·²åœ¨é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ GameplayTagï¼š
```
Data.Damage              // ä¼¤å®³å€ç‡æ ‡ç­¾
Ability.Attack           // æ”»å‡»æŠ€èƒ½æ ‡ç­¾
Unit.Type.Infantry       // æ­¥å…µç±»å‹æ ‡ç­¾
Unit.Type.Cavalry        // éª‘å…µç±»å‹æ ‡ç­¾
Unit.Type.Archer         // å¼“å…µç±»å‹æ ‡ç­¾
Unit.Type.Crossbow       // å¼©å…µç±»å‹æ ‡ç­¾
Unit.Faction.Player      // ç©å®¶é˜µè¥æ ‡ç­¾
Unit.Faction.Enemy       // æ•Œæ–¹é˜µè¥æ ‡ç­¾
```

é…ç½®è·¯å¾„ï¼š
```
Project Settings â†’ GameplayTags â†’ Add New Gameplay Tag
```

### **2. åŠ¨ç”»é…ç½®**
å¦‚æœæœ‰æ”»å‡»åŠ¨ç”»ï¼š
```
1. åˆ›å»ºæ”»å‡»åŠ¨ç”»è’™å¤ªå¥‡ï¼ˆAnim Montageï¼‰
2. åœ¨åŠ¨ç”»å…³é”®å¸§æ·»åŠ  Anim Notifyï¼š
   - ç±»å‹ï¼šAnim Notify State
   - åç§°ï¼šAttackHit
   - è§¦å‘æ—¶æœºï¼šæ­¦å™¨æŒ¥å‡ºçš„ç¬é—´
3. åœ¨ DataTable ä¸­é…ç½® Attack Montage
```

å¦‚æœæ²¡æœ‰æ”»å‡»åŠ¨ç”»ï¼š
```
1. æš‚æ—¶è·³è¿‡åŠ¨ç”»é…ç½®
2. æ”»å‡»èƒ½åŠ›ä¼šç›´æ¥è§¦å‘åˆ¤å®š
3. åç»­è¡¥å……åŠ¨ç”»èµ„æº
```

### **3. æŠ•å°„ç‰©æ¨¡å‹**
å¦‚æœæœ‰æŠ•å°„ç‰©æ¨¡å‹ï¼š
```
1. åœ¨ BP_Projectile_Arrow ä¸­æ·»åŠ  Static Mesh Component
2. è®¾ç½®ç®­çŸ¢æ¨¡å‹
3. è°ƒæ•´ç¼©æ”¾å’Œæ—‹è½¬ä½¿å…¶æŒ‡å‘å‰æ–¹
```

å¦‚æœæ²¡æœ‰æŠ•å°„ç‰©æ¨¡å‹ï¼š
```
1. ä½¿ç”¨é»˜è®¤çš„ Sphere Collision
2. å¯ä»¥æ·»åŠ  Particle System Component ä½œä¸ºä¸´æ—¶ç‰¹æ•ˆ
3. åç»­è¡¥å……ç¾æœ¯èµ„æº
```

---

## ğŸ“ **éœ€è¦æ‚¨çš„è¾“å…¥**

### **è¯·å›ç­”ä»¥ä¸‹é—®é¢˜ä»¥ç»§ç»­å¼€å‘ï¼š**

1. **ç¾æœ¯èµ„æºçŠ¶æ€**
   - â“ æ˜¯å¦æœ‰æ”»å‡»åŠ¨ç”»ï¼Ÿ
   - â“ æ˜¯å¦æœ‰æŠ•å°„ç‰©æ¨¡å‹ï¼Ÿ
   - â“ æ˜¯å¦æœ‰æŠ€èƒ½ç‰¹æ•ˆï¼Ÿ

2. **å¼€å‘æ–¹å‘**
   - â“ é€‰æ‹©æ–¹æ¡ˆ Aï¼ˆå®Œæ•´åŠŸèƒ½ï¼‰è¿˜æ˜¯æ–¹æ¡ˆ Bï¼ˆå¿«é€ŸéªŒè¯ï¼‰ï¼Ÿ
   - â“ æ˜¯å¦éœ€è¦æˆ‘å¸®åŠ©åˆ›å»ºè“å›¾èµ„äº§ï¼Ÿï¼ˆæä¾› C++ ä»£ç æˆ–è“å›¾æˆªå›¾ï¼‰

3. **ä¸‹ä¸€æ­¥ä¼˜å…ˆçº§**
   - â“ åˆ›å»ºè“å›¾èµ„äº§ï¼Ÿ
   - â“ åˆ›å»º StateTree AIï¼Ÿ
   - â“ å®ç°æ­¦å°†æŠ€èƒ½ï¼Ÿ
   - â“ å…¶ä»–éœ€æ±‚ï¼Ÿ

---

**è¯·å‘Šè¯‰æˆ‘æ‚¨çš„é€‰æ‹©ï¼Œæˆ‘ä¼šç»§ç»­å¼€å‘ï¼** ğŸš€
